# 実験計画法（DOE）種類と作成方法 - アプリケーション開発ガイド

## 1. 古典的実験計画法

### 1.1 直交実験（Orthogonal Arrays）
**概要**: L記号で表される直交表を用いた実験計画法
- **L8(2^7)**: 8実験で7因子まで評価可能
- **L9(3^4)**: 9実験で4因子まで評価可能（3水準）
- **L16(2^15)**: 16実験で15因子まで評価可能

**作成方法**:
- 各因子に対して水準を設定（通常2水準または3水準）
- 直交表に基づいて因子の組み合わせを決定
- 交絡（confounding）に注意して因子を割り当て

### 1.2 中心複合計画（Central Composite Design, CCD）
**概要**: 応答曲面法の代表的な計画
- **実験回数**: 2^k + 2k + n₀（k=因子数、n₀=中心点数）
- **特徴**: 2次の応答曲面モデルが構築可能

**作成方法**:
- 完全実施要因計画（2^k）
- 軸点（axial points）の追加（±α）
- 中心点の追加（複数回）

### 1.3 D最適化（D-Optimal Design）
**概要**: 統計的効率を最大化する最適計画
- **目的**: 分散共分散行列の行列式を最小化
- **利点**: 不規則な実験領域でも適用可能

**作成方法**:
- モデル行列Xの設計
- |X'X|^(-1)の最小化
- 交換アルゴリズムによる最適化

## 2. 現代的実験計画法

### 2.1 決定的スクリーニング計画（Definitive Screening Design, DSD）
**概要**: 2011年に提案された革新的スクリーニング計画
- **実験回数**: 2k+1（k=因子数）
- **特徴**: 主効果と2次効果の完全交絡なし

**作成方法**:
- カンファレンス行列Cの利用
- 3水準（-1, 0, +1）の設定
- 中心点の追加

**利点**:
- 古典的スクリーニング計画より少ない実験回数
- 2乗効果の推定が可能
- 交絡の大幅な削減

### 2.2 Box-Behnken計画（Box-Behnken Design, BBD）
**概要**: 2次の応答曲面計画
- **実験回数**: 2k(k-1) + n₀
- **特徴**: 球面設計、3水準のみ使用

### 2.3 プラケット・バーマン計画（Plackett-Burman Design）
**概要**: スクリーニング用の分解能III計画
- **実験回数**: 4の倍数
- **用途**: 多数の因子から重要因子を特定

## 3. 空間充填計画（Space-Filling Design）

### 3.1 ラテン超方格法（Latin Hypercube Sampling, LHS）
**概要**: 各因子の水準を均一に配置
- **特徴**: 一様分布を模倣
- **用途**: コンピュータ実験、シミュレーション

**作成方法**:
- 各因子を等間隔の層に分割
- 各層から1つずつサンプリング
- ランダムな組み合わせで配置

### 3.2 球の詰め込み（Sphere Packing）
**概要**: 点間の最短距離を最大化
- **目的**: 設計空間での点の最大分散
- **アルゴリズム**: 最適化による配置決定

### 3.3 一様計画（Uniform Design）
**概要**: 一様分布とのディスクレパンシーを最小化
- **手法**: 数論的方法
- **利点**: 数値積分に適している

### 3.4 最小ポテンシャル計画（Minimum Potential Design）
**概要**: 球面内に点を分散配置
- **特徴**: 球対称、ほぼ直交、間隔一様

### 3.5 最大エントロピー計画（Maximum Entropy Design）
**概要**: Shannonの情報量を最大化
- **用途**: 情報理論的最適化

### 3.6 高速柔軟充填計画（Fast Flexible Filling）
**概要**: 制約条件下での空間充填
- **アルゴリズム**: 
  1. ランダム点生成
  2. 制約条件の適用
  3. クラスター分析
  4. MaxPro最適化

## 4. ベイズ統計応用の実験計画法

### 4.1 ベイズ最適化（Bayesian Optimization）
**概要**: ガウス過程回帰と獲得関数を用いた適応的実験計画

**構成要素**:
- **ガウス過程回帰**: 予測値と不確実性の定量化
- **獲得関数**: 次の実験点を決定
  - UCB (Upper Confidence Bound)
  - EI (Expected Improvement)
  - PI (Probability of Improvement)

**フロー**:
1. 初期実験データの取得
2. ガウス過程回帰モデルの構築
3. 獲得関数による次の実験点決定
4. 実験実施とデータ更新
5. 収束まで繰り返し

### 4.2 適応的実験計画法（Adaptive Design of Experiments）
**概要**: データに基づいて実験計画を動的に更新
- **利点**: 実験回数の大幅削減
- **応用**: 材料開発、プロセス最適化

### 4.3 能動学習（Active Learning）
**概要**: 機械学習と実験計画法の融合
- **手法**: 
  - Uncertainty Sampling
  - Query by Committee
  - Expected Model Change

## 5. JMPでサポートされている実験計画法

### 5.1 スクリーニング計画
- 決定的スクリーニング計画
- プラケット・バーマン計画
- 部分実施要因計画

### 5.2 応答曲面計画
- 中心複合計画
- Box-Behnken計画
- Doehlert計画

### 5.3 カスタム計画
- D最適計画
- A最適計画
- G最適計画
- I最適計画
- 制約条件付き計画

### 5.4 Space Filling計画
- ラテン超方格法
- 球の詰め込み
- 一様計画
- 最小ポテンシャル計画
- 最大エントロピー計画
- Gauss過程IMSE最適計画
- 高速柔軟充填計画

### 5.5 混合物計画（Mixture Design）
- シンプレックス格子計画
- シンプレックス重心計画
- 極頂点計画

### 5.6 ナビ付きDOE（JMP 17新機能）
- 初心者向けガイド機能
- 段階的な実験計画作成支援

## 6. 最新のトレンドと手法

### 6.1 機械学習との融合
- **深層学習ベース実験計画**: ニューラルネットワークによる実験点選択
- **強化学習**: 実験戦略の学習
- **Transfer Learning**: 過去の実験知識の活用

### 6.2 マルチフィデリティ最適化
- 異なる精度レベルのモデルを組み合わせ
- 計算コストの削減

### 6.3 制約付きベイズ最適化
- 安全制約下での最適化
- 実用的な制約条件の考慮

### 6.4 多目的ベイズ最適化
- パレート最適解の探索
- 複数の目的関数の同時最適化

### 6.5 高次元ベイズ最適化
- 次元削減手法の活用
- 局所的モデリング

## 7. 実装における考慮事項

### 7.1 計算効率
- **ガウス過程**: O(n³)の計算複雑度
- **近似手法**: スパースガウス過程、変分ベイズ
- **並列化**: 複数実験の同時実行

### 7.2 カーネル関数の選択
- **RBF（Radial Basis Function）**: 最も一般的
- **Matérn**: 滑らかさの制御
- **Periodic**: 周期性のある現象

### 7.3 ハイパーパラメータ調整
- **周辺尤度最大化**: 自動調整
- **クロスバリデーション**: 汎化性能の確保

### 7.4 収束判定
- **Expected Improvement**: 閾値以下で停止
- **情報理論的基準**: 情報獲得量の評価

## 8. アプリケーション開発への推奨事項

### 8.1 基本機能の実装優先順位
1. **古典的手法**: 直交実験、中心複合計画、D最適化
2. **現代的手法**: 決定的スクリーニング計画、空間充填計画
3. **先端手法**: ベイズ最適化、適応的実験計画

### 8.2 ユーザビリティの考慮
- **ガイド機能**: 初心者向けの計画選択支援
- **可視化**: 実験点の配置図、予測曲面の表示
- **診断機能**: 計画の効率性評価

### 8.3 拡張性の確保
- **モジュラー設計**: 新しい手法の追加容易性
- **API設計**: 外部ライブラリとの連携
- **並列処理**: 大規模実験への対応

## 9. 参考実装ライブラリ

### 9.1 Python
- **scikit-learn**: ガウス過程回帰
- **GPy/GPyOpt**: ベイズ最適化
- **Optuna**: ハイパーパラメータ最適化
- **pyDOE**: 古典的実験計画法

### 9.2 R
- **DiceDesign**: 空間充填計画
- **DiceOptim**: ベイズ最適化
- **AlgDesign**: 最適計画
- **DoE.base**: 基本的実験計画

### 9.3 MATLAB
- **Statistics and Machine Learning Toolbox**: 実験計画法
- **Global Optimization Toolbox**: ベイズ最適化

この包括的なガイドにより、古典的な手法から最新のベイズ統計応用まで、実験計画法の全体像を把握し、アプリケーション開発に必要な技術的基盤を構築できます。