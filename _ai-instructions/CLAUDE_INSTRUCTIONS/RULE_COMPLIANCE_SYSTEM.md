# ルール遵守システム改善提案

## 現状の問題

### 情報過多問題
- **総計1,129行**の指示書は認知負荷が過大
- 特に`test_generation_rules.md`(471行)は実用性が低い
- 10ファイル分散により必要な情報の特定が困難

### 実際の遵守失敗
- React hooks問題の繰り返し発生
- プロジェクトデータ保護の未適用
- WSL2設定の参照漏れ
- API整合性テストの実施漏れ

## 改善提案

### 1. 緊急度ベースの階層化

#### Tier 1: 緊急（毎回必須）
- `CRITICAL_CHECKLIST.md` - 15項目以内
- データ消失防止
- 初期化エラー防止
- API接続確保

#### Tier 2: 重要（該当時必須）
- 各専門分野のベストプラクティス
- 50行以内に要約

#### Tier 3: 参考（詳細情報）
- 現在の長大な文書群
- 必要時のみ参照

### 2. 自動チェック機能の導入

#### ESLint/プリコミットフック強化
```json
{
  "husky": {
    "hooks": {
      "pre-commit": "npm run lint && npm run type-check"
    }
  }
}
```

#### チェックリスト自動表示
- セッション開始時に`CRITICAL_CHECKLIST.md`を自動表示
- 修正タイプに応じた関連ルールの自動提示

### 3. ルール統合の実施

#### 統合対象の特定
- `コーディング規約.md` + `命名規則.md` → `CODE_STANDARDS.md`
- `ファイル操作の約束事.md` → `project_data_protection.md`に統合
- `指示に対するClaudeCode基本動作.md` → 簡潔化

### 4. 違反検出機能

#### 自動検出項目
- React hooks順序エラー (ESLint)
- API整合性問題 (型チェック)
- プロジェクトデータ変更 (git diff監視)
- 未保存の一時ファイル検出

### 5. 段階的実装計画

#### Phase 1: 緊急対応（今回）
- [x] `CRITICAL_CHECKLIST.md` 作成
- [x] ESLint強化 (`react-hooks/exhaustive-deps`: "error")
- [ ] セッション開始時チェックリスト表示の習慣化

#### Phase 2: 中期対応（次回セッション）
- [ ] 長大文書の要約版作成
- [ ] 自動チェック機能実装
- [ ] ルール統合実施

#### Phase 3: 長期対応
- [ ] AI支援によるルール遵守チェック
- [ ] プロジェクト固有のルール自動生成

## 効果測定指標

- ルール違反による問題発生回数
- セッション中の修正回数
- プロジェクトデータ消失件数
- API整合性エラー発生率

---
**目標**: ルール違反による問題発生を80%削減